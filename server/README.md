## Gruppe 9

## Server API

## Installation

Install dependencies and start server files:

```sh
cd server
npm install
npm start
```
Run tests for server:

```sh
cd server
npm install
npm test
```

### API Documentation: Sporsmal (Questions) Service

#### 1. Get All Questions

```
GET /sporsmal
```

- **Description**: Retrieves a list of all questions.
- **Response**: An array of question objects.

```json
[
	{
		"sporsmalid": 1,
		"tittel": "Question Title",
		"innhold": "Question Content",
		"poeng": 10,
		"dato": "YYYY-MM-DDTHH:mm:ss.sssZ",
		"sistendret": "YYYY-MM-DDTHH:mm:ss.sssZ",
		"bestsvarid": null,
		"ersvart": false
	}
	// ...more questions
]
```

#### 2. Get a Question by ID

```
GET /sporsmal/:id
```

- **Description**: Retrieves a question by its ID.
- **Parameters**: `id` (integer) - Question ID.
- **Response**: A question object or 404 Not Found if the question does not exist.

```json
{
	"sporsmalid": 1,
	"tittel": "Question Title",
	"innhold": "Question Content",
	"poeng": 10,
	"dato": "YYYY-MM-DDTHH:mm:ss.sssZ",
	"sistendret": "YYYY-MM-DDTHH:mm:ss.sssZ",
	"bestsvarid": 1,
	"ersvart": true
}
```

#### 3. Create a New Question

```
POST /sporsmal
```

- **Description**: Creates a new question. ID is automatically generated by the database. `sistendret` is automatically set to the same value as `dato`, both generated by the server. The `bestsvarid` is automatically set to `null`. The `ersvart` is automatically set to `false` as there won't be generated an answer until a user posts one. The `ersvart` can be updated using the PUT endpoint.
- **Request Body**:

```json
{
	"sporsmal": {
		"tittel": "Question Title",
		"innhold": "Question Content",
		"poeng": 10,
		"dato": "YYYY-MM-DDTHH:mm:ss.sssZ",
		"sistendret": "YYYY-MM-DDTHH:mm:ss.sssZ"
	}
}
```

- **Response**: The ID of the newly created question.

```json
{
	"id": 1
}
```

#### 4. Update a Question

```
PUT /sporsmal
```

- **Description**: Updates an existing question. Every update automatically updates the `sistendret` field. Uses the `sporsmalid` included in the sent `sporsmal` object. Can be used to append a best answer to the question. If the `bestsvarid` is set to `null`, the question will be updated to not have a best answer.
- **Request Body**:

```json
{
	"sporsmal": {
		"sporsmalid": 1,
		"tittel": "Updated Question Title",
		"innhold": "Updated Question Content",
		"poeng": 15,
		"bestsvarid": 1
	}
}
```

- **Response**: 200 OK if the question is updated successfully, or 400 Bad Request if the request is malformed.

#### 5. Delete a Question

```
DELETE /sporsmal/:id
```

- **Description**: Deletes a question by its ID and all associated answers.
- **Parameters**: `id` (integer) - Question ID.
- **Response**: 200 OK if the question is deleted successfully, or 404 Not Found if the question does not exist.

### Error Handling

- If the server encounters an error while processing a request, it will respond with a 500 Internal Server Error and an error message describing the issue.
- Malformed requests will receive a 400 Bad Request response with an error message indicating the problem.

### Notes

- Deleting a question will also delete all associated answers.
- Dates (`dato` and `sistendret`) should be provided in ISO 8601 format (`YYYY-MM-DDTHH:mm:ss.sssZ`).

## API Documentation: Svar (Answers) Service

#### 1. Get All Answers for a Question

```
GET /sporsmal/:sporsmalid/svar
```

- **Description**: Retrieves all answers for a specific question.
- **Parameters**: `sporsmalid` (integer) - Question ID.
- **Response**: An array of answer objects.

```json
[
	{
		"svarid": 1,
		"svartekst": "Answer Text",
		"poeng": 5,
		"sporsmalid": 1,
		"dato": "YYYY-MM-DDTHH:mm:ss.sssZ",
		"sistendret": "YYYY-MM-DDTHH:mm:ss.sssZ",
		"ersvar": true,
		"svarsvarid": 2
	}
	// ...more answers
]
```

#### 2. Get an Answer by ID

```
GET /sporsmal/:sporsmalid/svar/:svarid
```

- **Description**: Retrieves an answer by its ID and the associated question ID.
- **Parameters**: `sporsmalid` (integer) - Question ID, `svarid` (integer) - Answer ID.
- **Response**: An answer object or 404 Not Found if the answer does not exist.

```json
{
	"svarid": 1,
	"svartekst": "Answer Text",
	"poeng": 5,
	"sporsmalid": 1,
	"dato": "YYYY-MM-DDTHH:mm:ss.sssZ",
	"sistendret": "YYYY-MM-DDTHH:mm:ss.sssZ",
	"ersvar": true,
	"svarsvarid": 2
}
```

#### 3. Create a New Answer for a Question

```
POST /sporsmal/:sporsmalid/svar
```

- **Description**: Creates a new answer for a specific question. ID is automatically generated by the database. Will also update the question the answer was posted to by setting "ersvart" to true allowing the system to see that the answer in face has an answer.
- **Parameters**: `sporsmalid` (integer) - Question ID.
- **Request Body**:

```json
{
	"svar": {
		"svartekst": "Answer Text",
		"poeng": 5,
		"sporsmalid": 1,
		"dato": "YYYY-MM-DDTHH:mm:ss.sssZ",
		"sistendret": "YYYY-MM-DDTHH:mm:ss.sssZ",
		"ersvar": false,
		"svarsvarid": null
	}
}
```

- **Response**: The ID of the newly created answer.

```json
{
	"id": 1
}
```

#### 4. Update an Answer for a Question

```
PUT /sporsmal/:sporsmalid/svar
```

- **Description**: Updates an existing answer for a specific question. Every update automatically updates the `sistendret` field.
- **Parameters**: `sporsmalid` (integer) - Question ID, `svarid` (integer) - Answer ID.
- **Request Body**:

```json
{
	"svar": {
		"svarid": 1,
		"svartekst": "Updated Answer Text",
		"poeng": 8
	}
}
```

- **Response**: 200 OK if the answer is updated successfully, or 400 Bad Request if the request is malformed.

#### 5. Delete an Answer for a Question

```
DELETE /sporsmal/:sporsmalid/svar/:svarid
```

- **Description**: Deletes an answer by its ID and the associated question ID.
- **Parameters**: `sporsmalid` (integer) - Question ID, `svarid` (integer) - Answer ID.
- **Response**: 200 OK if the answer is deleted successfully, or 404 Not Found if the answer does not exist.

### Error Handling

- If the server encounters an error while processing a request, it will respond with a 500 Internal Server Error and an error message describing the issue.
- Malformed requests will receive a 400 Bad Request response with an error message indicating the problem.

### Notes

- Dates (`dato` and `sistendret`) should be provided in ISO 8601 format (`YYYY-MM-DDTHH:mm:ss.sssZ`).
- `ersvar` indicates whether the answer is a response to another answer (true) or a direct response to the question (false).
- If `ersvar` is true, `svarsvarid` should contain the ID of the answer to which it is responding. If `ersvar` is false, `svarsvarid` should be null.

### API Documentation: Tag Service

#### 1. Get All Tags

```
GET /tag
```

- **Description**: Retrieves a list of all tags.
- **Response**: An array of tag objects.

```json
[
	{
		"tagid": 1,
		"navn": "Tag Name",
		"forklaring": "Tag Description"
	}
	// ...more tags
]
```

#### 2. Get a Tag by ID

```
GET /tag/:tagid
```

- **Description**: Retrieves a tag by its ID.
- **Parameters**: `tagid` (integer) - Tag ID.
- **Response**: A tag object or 404 Not Found if the tag does not exist.

```json
{
	"tagid": 1,
	"navn": "Tag Name",
	"forklaring": "Tag Description"
}
```

#### 3. Create a New Tag

```
POST /tag
```

- **Description**: Creates a new tag. ID is automatically generated by the database.
- **Request Body**:

```json
{
	"navn": "Tag Name",
	"forklaring": "Tag Description"
}
```

- **Response**: The ID of the newly created tag.

```json
{
	"id": 1
}
```

#### 4. Update a Tag

```
PUT /tag
```

- **Description**: Updates an existing tag. Uses the `tagid` included in the sent `tag` object.
- **Request Body**:

```json
{
	"tagid": 1,
	"navn": "Updated Tag Name",
	"forklaring": "Updated Tag Description"
}
```

- **Response**: 200 OK if the tag is updated successfully, or 400 Bad Request if the request is malformed.

#### 5. Delete a Tag

```
DELETE /tag/:tagid
```

- **Description**: Deletes a tag by its ID.
- **Parameters**: `tagid` (integer) - Tag ID.
- **Response**: 200 OK if the tag is deleted successfully, or 404 Not Found if the tag does not exist.

### Error Handling

- If the server encounters an error while processing a request, it will respond with a 500 Internal Server Error and an error message describing the issue.
- Malformed requests will receive a 400 Bad Request response with an error message indicating the problem.

### API Documentation: SporsmalTag Service

#### 1. Get Tags for a Question

```
GET /sporsmal/:sporsmalid/tags
```

- **Description**: Retrieves all tags associated with a specific question.
- **Parameters**: `sporsmalid` (integer) - Question ID.
- **Response**: An array of tag objects.

```json
[
	{
		"tagid": 1,
		"navn": "Tag Name",
		"forklaring": "Tag Description"
	}
	// ...more tags
]
```

#### 2. Get Questions for a Tag

```
GET /tag/:tagid/sporsmal
```

- **Description**: Retrieves all questions associated with a specific tag.
- **Parameters**: `tagid` (integer) - Tag ID.
- **Response**: An array of question objects.

```json
[
	{
		"sporsmalid": 1,
		"tittel": "Question Title",
		"innhold": "Question Content",
		"poeng": 10,
		"dato": "YYYY-MM-DDTHH:mm:ss.sssZ",
		"sistendret": "YYYY-MM-DDTHH:mm:ss.sssZ",
		"bestsvarid": null,
		"ersvart": false
	}
	// ...more questions
]
```

#### 3. Create a Relation Between a Question and a Tag

```
POST /sporsmalTag
```

- **Description**: Creates a relation between a question and a tag.
- **Request Body**:

```json
{
	"sporsmalid": 1,
	"tagid": 1
}
```

- **Response**: 200 OK if the relation is created successfully, or 400 Bad Request if the request is malformed or the relation already exists.

#### 4. Delete a Relation Between a Question and a Tag

```
DELETE /sporsmalTag/:sporsmalid/:tagid
```

- **Description**: Deletes a relation between a question and a tag.
- **Parameters**:
  - `sporsmalid` (integer) - Question ID.
  - `tagid` (integer) - Tag ID.
- **Response**: 200 OK if the relation is deleted successfully, or 404 Not Found if the relation does not exist.

### API Documentation: Favoritt Service

#### 1. Get All Favorited Answers

```
GET /favoritt
```

- **Description**: Retrieves all answers that have been favorited.
- **Response**: An array of favorited answer objects.

```json
[
	{
		"svarid": 1,
		"question": "Question Content",
		"answer": "Answer Content",
		"userid": 1,
		"dato": "YYYY-MM-DDTHH:mm:ss.sssZ",
		"poeng": 10,
		"best": true
	}
	// ...more favorited answers
]
```

#### 2. Add Answer to Favorites

```
POST /favoritt/:svarid
```

- **Description**: Adds an answer to the list of favorites.
- **Parameters**: `svarid` (integer) - Answer ID.
- **Response**: 200 OK if the answer is successfully added to favorites, or 400 Bad Request if the answer is already favorited or does not exist.

#### 3. Remove Answer from Favorites

```
DELETE /favoritt/:svarid
```

- **Description**: Removes an answer from the list of favorites.
- **Parameters**: `svarid` (integer) - Answer ID.
- **Response**: 200 OK if the answer is successfully removed from favorites, or 404 Not Found if the answer is not favorited.
